function NeighborhoodViewModel(){function e(e,n){if(n===google.maps.places.PlacesServiceStatus.OK){var i=Map.getMap(),a=new Marker(e[0],i);o.markers.push(a),$.ajax({url:"https://en.wikipedia.org/w/api.php?action=query&prop=extracts&format=json&exintro=&titles="+a.name,type:"GET",crossDomain:!0,dataType:"jsonp",timeout:5e3,success:function(e){var o;try{var n=Object.keys(e.query.pages)[0];o=$($(e.query.pages[n].extract)[0].innerHTML).text()}catch(i){o="Could not get additional information."}a.setInfoWindow(o)},error:function(){o.content("Could not get additional information.")}}),o.visibleMarkersCount(o.visibleMarkersCount()+1),o.locationLat("")}}var o=this;ko.bindingHandlers.mapBinder={init:function(e,o,n,i){Map.setMap(o,e)}},o.centerMap=ko.observable(Map.getMapCenter()),o.mapDimensions=ko.observable(Map.getMapDimensions()),o.markers=ko.observableArray([]),o.locationLat=ko.observable(""),o.addNewMarkerOnMap=function(){o.addMarkerOnMap(o.locationLat(),e())},o.addMarkerOnMap=function(o){Map.addMarkerGeneric(o,e)},o.toggle=ko.observable(!0),o.titleSearch=ko.observable(""),o.filteredMarkers=this.markers.filterByProperty("visible",!0),o.visibleMarkersCount=ko.observable(0),o.showDummyCard=ko.computed(function(){return 0===o.visibleMarkersCount()&&o.toggle}),o.markerToggler=function(e){o.visibleMarkersCount(0);for(var n in o.markers()){var i=o.markers()[n];i.isVisible(null!==i.title().match(e)),i.isVisible()&&o.visibleMarkersCount(o.visibleMarkersCount()+1)}},this.toggle.subscribe(function(e){o.markerToggler(e?"":null)}),this.toggleMarkersForSearch=function(e){var n=new RegExp(e,"i");o.markerToggler(n)},o.titleSearch.subscribe(o.toggleMarkersForSearch)}function initialize(){var e=["New York, NY","London, UK","Mumbai, India","Paris, France"];for(var o in e)(new NeighborhoodViewModel).addMarkerOnMap(e[o])}function setDataFromWikipedia(e,o){$.ajax({url:"https://en.wikipedia.org/w/api.php?action=query&prop=extracts&format=json&exintro=&titles="+e,type:"GET",crossDomain:!0,dataType:"jsonp",timeout:5e3,success:function(e){var n;try{var i=Object.keys(e.query.pages)[0];n=$($(e.query.pages[i].extract)[0].innerHTML).text()}catch(a){n="Could not get additional information."}o.setInfoWindow(n)},error:function(){self.content("Could not get additional information.")}})}ko.observableArray.fn.filterByProperty=function(e,o){return ko.pureComputed(function(){for(var n=this(),i=[],a=0;a<n.length;a++){var t=n[a];ko.unwrap(t[e])===o&&i.push(t)}return i},this)};var Map={setMap:function(e,o){var n=ko.utils.unwrapObservable(e()),i=new google.maps.LatLng(ko.utils.unwrapObservable(n.lat),ko.utils.unwrapObservable(n.lng)),a={center:i,zoom:13};this.map=new google.maps.Map(o,a),window.mapBounds=new google.maps.LatLngBounds,this.searchService=new google.maps.places.PlacesService(this.map),this.infoWindow=new google.maps.InfoWindow({content:""})},getMap:function(){return this.map},getMapCenter:function(){return{lat:ko.observable(40.7127),lng:ko.observable(-74.0059)}},getMapDimensions:function(){var e=$("main").height()+40;return{width:"100%",height:""+e+"px"}},setInfoWindow:function(e,o){this.infoWindow.setContent(e),this.infoWindow.open(this.map,o)},addMarkerGeneric:function(e,o){var n=this.searchService,i={query:e};n.textSearch(i,o)}},Marker=function(e,o){var n=e.geometry.location.lat(),i=e.geometry.location.lng(),a=e.formatted_address,t=this;t.icon={url:e.icon,size:new google.maps.Size(80,80),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)},t.title=ko.observable(a),t.name=e.name,t.content=ko.observable(""),t.infolink=ko.observable("https://en.wikipedia.org/wiki/"+t.name),t.googleMarker=new google.maps.Marker({position:new google.maps.LatLng(n,i),animation:google.maps.Animation.DROP,icon:t.icon,map:o}),t.setInfoWindow=function(e){google.maps.event.addListener(t.googleMarker,"click",function(){Map.setInfoWindow(e,t.googleMarker)})},t.isVisible=ko.observable(!1),t.isVisible.subscribe(function(e){t.googleMarker.setMap(e?o:null)}),t.isVisible(!0);var r=window.mapBounds;r.extend(new google.maps.LatLng(n,i)),o.fitBounds(r),o.setCenter(r.getCenter())};ko.applyBindings(NeighborhoodViewModel),$(window).resize(function(){google.maps.event.trigger(Map.getMap(),"resize")}),Offline.options={checkOnLoad:!0,interceptRequests:!0,requests:!0,game:!0};var run=function(){"up"===Offline.state&&Offline.check()};setInterval(run,5e3),$(window).load(function(){initialize()});
//# sourceMappingURL=all.min.js.map