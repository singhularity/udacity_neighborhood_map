function NeighborhoodViewModel(){function e(e,n){if(void 0!==e&&e.length>0){var o=Map.getMap(),i=new Marker(e[0],o);return a.markers.push(i),a.visibleMarkersCount(a.visibleMarkersCount()+1),a.locationLat(""),a.selectedType(""),i}alert("No matching location found!")}function n(n,o){if(o===google.maps.places.PlacesServiceStatus.OK){var a=e(n,o);setDataFromWikipedia(a)}}function o(n,o){if(o===google.maps.places.PlacesServiceStatus.OK){var a=e(n,o);setDataFromYelp(a)}}var a=this;ko.bindingHandlers.mapBinder={init:function(e,n,o,a){Map.setMap(n,e)}};var i={City:{google_name:"locality",func:n},Business:{google_name:"restaurant",func:o}};a.centerMap=ko.observable(Map.getMapCenter()),a.mapDimensions=ko.observable(Map.getMapDimensions()),a.markers=ko.observableArray(),a.locationLat=ko.observable(""),a.availableTypes=ko.observableArray(["City","Business"]),a.selectedType=ko.observable(),a.addNewMarkerOnMap=function(){void 0===a.selectedType()?alert("Please select the type of location!"):a.addMarkerWithInfo(a.locationLat(),a.selectedType())},a.addMarkerWithInfo=function(e,n){var o=i[n].func;Map.addMarkerOnMap(e,o,i[n].google_name)},a.toggle=ko.observable(!0),a.titleSearch=ko.observable(""),a.filteredMarkers=a.markers.filterByProperty("visible",!0),a.visibleMarkersCount=ko.observable(0),a.showDummyCard=ko.computed(function(){return 0===a.visibleMarkersCount()&&a.toggle}),a.markerToggler=function(e){a.visibleMarkersCount(0);for(var n in a.markers()){var o=a.markers()[n];o.isVisible(null!==o.title().match(e)),o.isVisible()&&a.visibleMarkersCount(a.visibleMarkersCount()+1)}},this.toggle.subscribe(function(e){a.markerToggler(e?"":null)}),this.toggleMarkersForSearch=function(e){var n=new RegExp(e,"i");a.markerToggler(n)},a.titleSearch.subscribe(a.toggleMarkersForSearch)}function setDataFromServer(e,n,o){"down"===Offline.state?alert("No network"):$.ajax({url:e,type:"GET",dataType:"json",timeout:5e3,success:function(e){o(n,e)},error:function(){n.setClickEvent("Could not get additional information.")}})}function setDataFromWikipedia(e){setDataFromServer("/wikiData?name="+e.name,e,wikipediaDataCallback)}function setDataFromYelp(e){setDataFromServer("/yelpData?address="+e.name,e,yelpDataCallback)}function wikipediaDataCallback(e,n){var o=n.content;e.setClickEvent("<div>"+o+"</div>"),e.infolink("https://en.wikipedia.org/wiki/"+e.name)}function yelpDataCallback(e,n){var o=n.content,a="<ul></ul>";a=$(a).html($("<li><strong>Name:&nbsp;</strong>"+o.Name+"</li><li><strong>Rating:&nbsp;</strong>"+o.Rating+"</li><li><strong>Summary/Comments:&nbsp;</strong>"+o.Summary+"</li><li><strong>Phone:&nbsp;</strong>"+o.Phone+"</li>")),e.setClickEvent($(a).html()),e.infolink(o.Url)}function initializeOfflineJs(){Offline.options={checkOnLoad:!0,interceptRequests:!0,requests:!0,game:!0,checks:{xhr:{url:"/heartbeat"}}};var e=function(){"up"===Offline.state&&Offline.check()};setInterval(e,5e3)}function initialize(e){initializeOfflineJs();var n=["New York, NY","London, UK","Mumbai, India","Paris, France"],o=["Rockefeller Center, New York","Learning Tower, Pisa"];for(var a in n)e.addMarkerWithInfo(n[a],"City");for(var i in o)e.addMarkerWithInfo(o[i],"Business")}ko.observableArray.fn.filterByProperty=function(e,n){var o=this;return ko.pureComputed(function(){for(var a=o(),i=[],t=0;t<a.length;t++){var r=a[t];ko.unwrap(r[e])===n&&i.push(r)}return i},o)};var Map={setMap:function(e,n){var o=ko.utils.unwrapObservable(e()),a=new google.maps.LatLng(ko.utils.unwrapObservable(o.lat),ko.utils.unwrapObservable(o.lng)),i={center:a,zoom:13};this.map=new google.maps.Map(n,i),window.mapBounds=new google.maps.LatLngBounds,this.searchService=new google.maps.places.PlacesService(this.map),this.infoWindow=new google.maps.InfoWindow({content:""})},getMap:function(){return this.map},getMapCenter:function(){return{lat:ko.observable(40.7127),lng:ko.observable(-74.0059)}},getMapDimensions:function(){var e=$("main").height()+40;return{width:"100%",height:""+e+"px"}},setInfoWindow:function(e,n){this.infoWindow.setContent(e),this.infoWindow.open(this.map,n)},addMarkerOnMap:function(e,n,o){var a=this.searchService,i={query:e,type:o};"down"===Offline.state?alert("No network"):a.textSearch(i,n)}},Marker=function(e,n){var o=e.geometry.location.lat(),a=e.geometry.location.lng(),i=e.formatted_address,t=this;t.icon={url:e.icon,size:new google.maps.Size(80,80),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)},t.title=ko.observable(i),t.name=e.name,t.content=ko.observable(""),t.infolink=ko.observable(""),t.googleMarker=new google.maps.Marker({position:new google.maps.LatLng(o,a),animation:google.maps.Animation.DROP,icon:t.icon,map:n}),t.setClickEvent=function(e){this.content(e),google.maps.event.addListener(t.googleMarker,"click",function(){Map.setInfoWindow(e,t.googleMarker)})},t.isVisible=ko.observable(!1),t.isVisible.subscribe(function(e){t.googleMarker.setMap(e?n:null)}),t.isVisible(!0);var r=window.mapBounds;r.extend(new google.maps.LatLng(o,a)),n.fitBounds(r),n.setCenter(r.getCenter())};$(window).resize(function(){google.maps.event.trigger(Map.getMap(),"resize")});var neighbourHood=new NeighborhoodViewModel;ko.applyBindings(neighbourHood),initialize(neighbourHood);
//# sourceMappingURL=all.min.js.map