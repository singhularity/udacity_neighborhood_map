function NeighborhoodViewModel(){function e(e,o){var i=Map.getMap(),a=new Marker(e[0],i);return n.markers.push(a),n.visibleMarkersCount(n.visibleMarkersCount()+1),n.locationLat(""),a}function o(o,n){if(n===google.maps.places.PlacesServiceStatus.OK){var i=e(o,n);setDataFromWikipedia(i)}}var n=this,i={Location:o};ko.bindingHandlers.mapBinder={init:function(e,o,n,i){Map.setMap(o,e)}},n.centerMap=ko.observable(Map.getMapCenter()),n.mapDimensions=ko.observable(Map.getMapDimensions()),n.markers=ko.observableArray([]),n.locationLat=ko.observable(""),n.addNewMarkerOnMap=function(){n.addMarkerOnMap(n.locationLat(),o)},n.addMarkerWithInfo=function(e,o){var n=i[o];Map.addMarkerOnMap(e,n)},n.toggle=ko.observable(!0),n.titleSearch=ko.observable(""),n.filteredMarkers=this.markers.filterByProperty("visible",!0),n.visibleMarkersCount=ko.observable(0),n.showDummyCard=ko.computed(function(){return 0===n.visibleMarkersCount()&&n.toggle}),n.markerToggler=function(e){n.visibleMarkersCount(0);for(var o in n.markers()){var i=n.markers()[o];i.isVisible(null!==i.title().match(e)),i.isVisible()&&n.visibleMarkersCount(n.visibleMarkersCount()+1)}},this.toggle.subscribe(function(e){n.markerToggler(e?"":null)}),this.toggleMarkersForSearch=function(e){var o=new RegExp(e,"i");n.markerToggler(o)},n.titleSearch.subscribe(n.toggleMarkersForSearch)}function initialize(e){var o=["New York, NY","London, UK","Mumbai, India","Paris, France"];for(var n in o)e.addMarkerWithInfo(o[n],"Location")}function setDataFromWikipedia(e){$.ajax({url:"https://en.wikipedia.org/w/api.php?action=query&prop=extracts&format=json&exintro=&titles="+e.name,type:"GET",crossDomain:!0,dataType:"jsonp",timeout:5e3,success:function(o){var n;try{var i=Object.keys(o.query.pages)[0];n=$($(o.query.pages[i].extract)[0].innerHTML).text()}catch(a){n="Could not get additional information."}e.setClickEvent(n)},error:function(){self.content("Could not get additional information.")}})}ko.observableArray.fn.filterByProperty=function(e,o){return ko.pureComputed(function(){for(var n=this(),i=[],a=0;a<n.length;a++){var r=n[a];ko.unwrap(r[e])===o&&i.push(r)}return i},this)};var Map={setMap:function(e,o){var n=ko.utils.unwrapObservable(e()),i=new google.maps.LatLng(ko.utils.unwrapObservable(n.lat),ko.utils.unwrapObservable(n.lng)),a={center:i,zoom:13};this.map=new google.maps.Map(o,a),window.mapBounds=new google.maps.LatLngBounds,this.searchService=new google.maps.places.PlacesService(this.map),this.infoWindow=new google.maps.InfoWindow({content:""})},getMap:function(){return this.map},getMapCenter:function(){return{lat:ko.observable(40.7127),lng:ko.observable(-74.0059)}},getMapDimensions:function(){var e=$("main").height()+40;return{width:"100%",height:""+e+"px"}},setInfoWindow:function(e,o){this.infoWindow.setContent(e),this.infoWindow.open(this.map,o)},addMarkerOnMap:function(e,o){var n=this.searchService,i={query:e};n.textSearch(i,o)}},Marker=function(e,o){var n=e.geometry.location.lat(),i=e.geometry.location.lng(),a=e.formatted_address,r=this;r.icon={url:e.icon,size:new google.maps.Size(80,80),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)},r.title=ko.observable(a),r.name=e.name,r.content=ko.observable(""),r.infolink=ko.observable("https://en.wikipedia.org/wiki/"+r.name),r.googleMarker=new google.maps.Marker({position:new google.maps.LatLng(n,i),animation:google.maps.Animation.DROP,icon:r.icon,map:o}),r.setClickEvent=function(e){this.content(e),google.maps.event.addListener(r.googleMarker,"click",function(){Map.setInfoWindow(e,r.googleMarker)})},r.isVisible=ko.observable(!1),r.isVisible.subscribe(function(e){r.googleMarker.setMap(e?o:null)}),r.isVisible(!0);var t=window.mapBounds;t.extend(new google.maps.LatLng(n,i)),o.fitBounds(t),o.setCenter(t.getCenter())};$(window).resize(function(){google.maps.event.trigger(Map.getMap(),"resize")}),Offline.options={checkOnLoad:!0,interceptRequests:!0,requests:!0,game:!0};var run=function(){"up"===Offline.state&&Offline.check()};setInterval(run,5e3);var neighbourHood=new NeighborhoodViewModel;ko.applyBindings(neighbourHood),initialize(neighbourHood);
//# sourceMappingURL=all.min.js.map